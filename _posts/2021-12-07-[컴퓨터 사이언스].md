---
title:  "사용자모드와 커널모드"
excerpt: "커널모드"
categories:
  - CS
tags:
  - [CS, 운영체제]

toc: true
toc_sticky: true
 
date: 2021-12-07
last_modified_at: 2021-12-07
---

# 운영체제 구조 - 사용자와 커널 모드
- Intel 기준으로 cpu protection ring을 4가지로 분류 했을 때 ring 0에 해당하는 부분이 커널 , 3에 해당하는 부분이 사용자 권한이다. 

<br>

### 커널모드 : 특권 명령어 실행과 원하는 작업수행을 위한 자원 접근을 가능케 하는 모드(Os의 핵심기능)  
<br>

### 사용자 모드 : 응용 프로그램단에서 사용하는 모드


<br>
만약 1~100을 더하고 나서 파일에서 데이터를 가져오고 가져온 데이터와 1~100을 더하는 과정을 진행했다고 가정한다.  

이때 파일에서 데이터를 가져오는 과정은 파일을 읽어오는 **system call**을 통해 운영체제의 커널모드를 통해 디스크에서 가져와서 전달한다. 

--> 시스템 콜은 커널 모드로 실행된다. 
- 커널 모드에서만 실행 가능한 기능 들이 있다. 
- 커널 모드로 실행하려면 시스템 콜을 사용해야 한다. 
 - 따라서 이러한 시스템 콜을 잘 활용하고 제공하기 위한 운영체제의 구현이 중요핟하다. 

### ***그럼 왜 커널 모드가 필요할까?***
- 함부로 응용 프로그램이 전체 컴퓨터 시스템을 해치지 못하게 하기 위함이다. 
- 시민(사용자, 응용프로그램)은 특별한 신청서(시스템 콜)을 제출해야 동사무소(커널모드)는 그 권한으로 주민등록증 출력(리소스)을 해준다. 



***코드에서 파일을 open 했을 때 과정***
1. open() (헤더 파일로 시스템 콜 호출)
2. 커널 모드로 전환
3. open() 함수를 처리하는 운영체제 함수 sys_open() 커널 함수 호출
4. 파일 열기로 레벨 연산 수행
5. 결과를 전달하고 사용자 모드로 전환
6. 이후 코드 진행 

-----------------
## 정리 
- 운영체제는 시스템 콜을 제공한다. 
- 프로그래밍 언어별로 시스템 콜을 호출를 통한 운영체제 기능을 활용하기 위한 api를 제공한다. 
- 응용프로그램이 실행되어 운영체제 기능이 필요한 api를 호출하면 시스템 콜이 호출 되고 커널 모드로 변경되어 운영체제 내부에서 해당 명령이 진행되고 다시 사용자 모드로 복귀한다. 


